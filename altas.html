<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../src/exindex.css">
    <title>Altas</title>
</head>
<body>
    <header>
        <div class="contenedor-logo-center" id="logo">
            
                <h4>Asia</h4>
                <h6>Indumentaria</h6>
                <span>I N T R A N E T</span>
                <br>
                <span>  Altas  </span>
        </div>
    </header>
 
    <form id="formulario" enctype="multipart/form-data">
        <label for="titulo">Título</label>
        <input type="text" id="titulo" name="titulo" required><br>

        <label for="descripcion">Descripcion</label>
        <input type="text" id="descripcion" name="descripcion" required><br>

        <label for="cantidad">Cantidad</label>
        <input type="number" id="cantidad" name="cantidad" required><br>

        <label for="precio">Precio</label>
        <input type="number" step= "0.01" id="precio" name="precio" required><br>

        <label for="imagenProducto">Imagen del Producto</label>
        <input type="file" id="imagenProducto" name="imagen" required><br>

        <br><br>
        
        <button type="submit">Agregar Producto</button>
        <a href="./exindex.html"> Volver al Menú</a>
    </form>

    <script>
        const URL = "http://127.0.0.1:5000/"
        // Reemplazar el siguiente USUARIO por el usuario de Pythonanywhere LE SAQUE EL URL PORQUE DABA ERROR
        //const PEP = " https://USUARIO.pythonanywhere.com"  // PEPE y PEP eran URL

        // Capturamos el evento de envio del formulario
document.getElementById('formulario').addEventListener('submit', function(event) {
    event.preventDefault();
    var formData = new FormData(this);
    fetch(URL + 'productos',{
        method: 'POST',
        body: formData
    })

    // Utilizamos el método then para manejar la respuesta del servidor

    .then(function(response) {
        if (response.ok) {
            return response.json();
        } else {
            throw new Error('Error al agregar el producto');
        }
    })
    .then(function(data) {
        alert('Producto agregado correctamente');
    })
    .catch(function(error) {
        alert('Error al agregar el producto');
    })
    // Limpiamos el formulario

    .finally(function() {
        document.getElementById('titulo').value = "";
        document.getElementById('descripcion').value = "";
        document.getElementById('cantidad').value = "";
        document.getElementById('precio').value = "";
        document.getElementById('imagenProducto').value = "";
    })

})


    </script>

    
</body>
</html>